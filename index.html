<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Postman Automation Guide: SAP Integration Content</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #004c8c;
            border-bottom: 3px solid #004c8c;
            padding-bottom: 10px;
        }
        h2 {
            color: #007bff;
            margin-top: 25px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }
        h3 {
            color: #28a745;
            margin-top: 20px;
        }
        .section-separator {
            border: 0;
            height: 1px;
            background-color: #ddd;
            margin: 20px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            color: #555;
        }
        .runner-step {
            font-weight: bold;
            color: #dc3545;
        }
        code {
            /*background-color: #eee;*/
            padding: 2px 4px;
            border-radius: 3px;
            font-family: monospace;
        }
        pre {
            background-color: #666666; 
            color: #f2f2f2;  
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ccc;
            overflow-x: auto;
            font-size: 0.9em;
        }
        /* Index Specific Styles */
        #toc {
            border: 1px solid #007bff;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 5px;
            background-color: #eaf6ff;
        }
        #toc ul {
            list-style-type: none;
            padding: 0;
        }
        #toc ul li a {
            text-decoration: none;
            color: #004c8c;
        }
        #toc ul li a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Postman Automation Guide: SAP Integration Content</h1>
        <p>This document provides a comprehensive guide for using the <strong>Integration Content - Automation</strong> Postman Collection, designed to automate interaction with the SAP Integration Suite (formerly CPI/HCI) OData API for Integration Content.</p>

        <hr class="section-separator">

        <div id="toc">
            <h2>Index (Table of Contents)</h2>
            <ul>
                <li><a href="#section-1">1. Overview and Prerequisites</a></li>
                <li><a href="#section-2">2. Collection Variables: Configuration & Control</a></li>
                <li><a href="#section-3">3. Detailed Workflows</a>
                    <ul>
                        <li><a href="#section-3-1">3.1. Folder 01: Get Integration Content (Full Scan)</a></li>
                        <li><a href="#section-3-2">3.2. Folder 1.1: Get Specific Integration Content (Specific Scan)</a></li>
                        <li><a href="#section-3-3">3.3. Folder 02: Update Iflow Configuration (Mass Update)</a></li>
                        <li><a href="#section-3-4">3.4. Detailed Workflows: Mass Deployment and Undeployment</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        
        <hr class="section-separator">

        <h2 id="section-1">1. üöÄ Overview and Prerequisites</h2>

        <h3>Collection Purpose</h3>
        <ul>
            <li><strong>Content Discovery & Backup (Folder 01/1.1)</strong>: Retrieve a list of all Integration Packages and Flows (iFlows), their parameters, and optionally download them as <code>.zip</code> files.</li>
            <li><strong>Mass Configuration Update (Folder 02)</strong>: Update configuration parameters for multiple iFlows based on a provided CSV data file.</li>
            <li><strong>Mass Deployment/Undeployment (Folders 03, 04, 05, 06)</strong>: Deploy or undeploy various artifact types (iFlows, Script Collections, Value Mappings) using a data file.</li>
        </ul>

        <h3>Mandatory Prerequisites</h3>
        <p>Before running any request, you must configure the following in the <strong>Collection Variables</strong> tab within Postman:</p>
        <table>
            <thead>
                <tr>
                    <th>Variable</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>baseUrl</code></td>
                    <td>The base URL for the Integration Content OData API (e.g., <code>https://&lt;tenantID&gt;-tmn.hci.eu1.hana.ondemand.com/api/v1</code>).</td>
                </tr>
                <tr>
                    <td><code>TokenUrl</code></td>
                    <td>The URL for fetching the OAuth token (e.g., <code>https://&lt;tenantID&gt;.authentication.sap.hana.ondemand.com/oauth/token</code>).</td>
                </tr>
                <tr>
                    <td><code>ClientID</code></td>
                    <td>The OAuth Client ID (User) for API access.</td>
                </tr>
                <tr>
                    <td><code>ClientSecret</code></td>
                    <td>The OAuth Client Secret (Password) for API access.</td>
                </tr>
            </tbody>
        </table>

        <hr class="section-separator">

        <h2 id="section-2">2. ‚öôÔ∏è Collection Variables: Configuration & Control</h2>
        <p>The following variables control the behavior of the collection's workflows. You must set these variables <em>before</em> running any request that relies on them.</p>

        <table>
            <thead>
                <tr>
                    <th>Variable</th>
                    <th>Control</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>Version</code></td>
                    <td>Configuration</td>
                    <td>The version of the artifact to retrieve configurations for or deploy. Defaults to <code>active</code>.</td>
                </tr>
                <tr>
                    <td><code>logging</code></td>
                    <td>Logging</td>
                    <td>Set to <strong><code>true</code></strong> to enable verbose logging in the Postman Console.</td>
                </tr>
                <tr>
                    <td><code>runGetConfigurations</code></td>
                    <td>Folder 01 Control</td>
                    <td>Set to <strong><code>true</code></strong> to fetch configuration parameters for each iFlow. <strong>Requires <code>nodeServerUrl</code></strong>.</td>
                </tr>
                <tr>
                    <td><code>runDownloadFlow</code></td>
                    <td>Folder 01 Control</td>
                    <td>Set to <strong><code>true</code></strong> to download the iFlow <code>.zip</code> file. <strong>Requires <code>nodeServerUrl</code></strong>.</td>
                </tr>
                <tr>
                    <td><code>nodeServerUrl</code></td>
                    <td>Node.js Integration</td>
                    <td>Base URL for a local Node.js server (e.g., <code>http://localhost:3000</code>). Required for saving files/reports when using download or configuration retrieval features.</td>
                </tr>
                <tr>
                    <td><code>specificPackageIDsList</code></td>
                    <td>Folder 1.1 Input</td>
                    <td>A <strong>comma-separated list</strong> of specific Package IDs (e.g., <code>ID1,ID2,ID3</code>) to process when running <strong>Folder 1.1</strong>.</td>
                </tr>
            </tbody>
        </table>

        <hr class="section-separator">

        <h2 id="section-3">3. üõ†Ô∏è Detailed Workflows</h2>

        <h3 id="section-3-1">3.1. Folder 01: Get Integration Content (Full Scan)</h3>
        <p>This workflow scans <strong>all</strong> integration packages in your tenant to gather lists, configurations, and optionally download the files.</p>

        <h4>How to Run</h4>
        <ol>
            <li>Set the control variables (<code>runGetConfigurations</code>, <code>runDownloadFlow</code>, <code>nodeServerUrl</code>) in the Collection Variables tab based on your requirements.</li>
            <li>Start the collection run by executing the first request in the folder: <strong><code>01 - Get Auth Token</code></strong>.</li>
        </ol>

        <h4>Workflow Steps</h4>
        <table>
            <thead>
                <tr>
                    <th>Request Name</th>
                    <th>Method</th>
                    <th>Purpose &amp; Functionality</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong><code>01 - Get Auth Token</code></strong></td>
                    <td><code>POST</code></td>
                    <td>Fetches the <code>accessToken</code>. Clears old tokens and optionally clears cookies.</td>
                </tr>
                <tr>
                    <td><strong><code>Get all integration packages</code></strong></td>
                    <td><code>GET</code></td>
                    <td><strong>Step 1: Discover Packages.</strong> Retrieves a list of all packages. Initializes loop variables and summary variables (<code>TotalPackageCount</code>, <code>PackageCsvList</code>).</td>
                </tr>
                <tr>
                    <td><strong><code>Get all integration flows of a package.</code></strong></td>
                    <td><code>GET</code></td>
                    <td><strong>Step 2: Loop through Packages.</strong> For the current package, it retrieves all contained iFlows. Updates <code>TotalIflowCount</code> and sets up the inner iFlow loop.</td>
                </tr>
                <tr>
                    <td><strong><code>Get configurations of an integration flow by Id and version.</code></strong></td>
                    <td><code>GET</code></td>
                    <td><strong>Step 3a: Get Configurations.</strong> (Only if <code>runGetConfigurations=true</code>). Retrieves config parameters (key/value pairs). <strong>Appends data to <code>csvData</code> for the final report.</strong></td>
                </tr>
                <tr>
                    <td><strong><code>Download an integration flow as zip file</code></strong></td>
                    <td><code>GET</code></td>
                    <td><strong>Step 3b: Download Files.</strong> (If <code>runDownloadFlow=true</code>). Downloads the iFlow binary. <strong>Sends the binary data to the configured <code>nodeServerUrl</code></strong> to be saved locally. Also acts as the <strong>iFlow loop controller</strong>, routing to the next iFlow or back to the package loop.</td>
                </tr>
            </tbody>
        </table>

        <h3 id="section-3-2">3.2. Folder 1.1: Get Specific Integration Content (Specific Scan)</h3>
        <p>This is an optimized workflow designed to fetch configurations for <strong>only a specific list of packages</strong> defined in the <code>specificPackageIDsList</code> variable.</p>

        <h4>How to Run</h4>
        <ol>
            <li>Set the <code>specificPackageIDsList</code> variable with a comma-separated list of the Package IDs you want to process (e.g., <code>ID_A,ID_B,ID_C</code>).</li>
            <li>Start the Collection Runner from the first request in the folder: <strong><code>Logic: Specific Package Iteration</code></strong>.</li>
        </ol>

        <h3 id="section-3-3">3.3. Folder 02: Update Iflow Configuration (Mass Update)</h3>
        <p>This workflow is used to <strong>mass update</strong> configuration parameters of iFlows using the <strong>Postman Collection Runner</strong> and an attached data file.</p>

        <h4>Data File Preparation (Required CSV Headers)</h4>
        <p>You must create a data file (CSV) with the following mandatory headers. Each row will represent one configuration parameter to be updated:</p>
        <table>
            <thead>
                <tr>
                    <th>Header</th>
                    <th>Description</th>
                    <th>Example Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong><code>IflowID</code></strong></td>
                    <td>The ID of the Integration Flow artifact.</td>
                    <td><code>My_Interface</code></td>
                </tr>
                <tr>
                    <td><strong><code>Version</code></strong></td>
                    <td>The version of the Integration Flow (e.g., specific version or <code>active</code>).</td>
                    <td><code>1.0.0</code> or <code>active</code></td>
                </tr>
                <tr>
                    <td><strong><code>ParameterKey</code></strong></td>
                    <td>The technical key of the configuration parameter (e.g., Receiver, Endpoint URL).</td>
                    <td><code>Receiver_SOAP_Host</code></td>
                </tr>
                <tr>
                    <td><strong><code>ParameterValue</code></strong></td>
                    <td>The <strong>new value</strong> for the parameter.</td>
                    <td><code>https://new.endpoint.com/service</code></td>
                </tr>
                <tr>
                    <td><strong><code>DataType</code></strong></td>
                    <td>The expected data type of the parameter (usually <code>xsd:string</code>).</td>
                    <td><code>xsd:string</code></td>
                </tr>
            </tbody>
        </table>

        <p><strong>Sample CSV Input (<code>Update_Configs.csv</code>):</strong></p>
        <pre><code>PackageName,PackageID,IflowName,IflowID,Version,ParameterKey,ParameterValue,DataType
ERP_Sync,PKG_ERP_SYNC,ERP_To_S4,IFLOW_S4,active,Receiver_Host,https://s4hana.new.com/api,xsd:string
CRM_Sync,PKG_CRM_SYNC,CRM_To_SF,IFLOW_SF,active,Client_ID,newClientIDvalue,xsd:string
HCM_Flows,PKG_HCM,Hiring_SF,IFLOW_HR,1.0.5,Sender_URL_Path,/new/path/hcm,xsd:string</code></pre>

        <h4>How to Run</h4>
        <ol>
            <li><strong>Prepare the Data File:</strong> Create the CSV file as specified above.</li>
            <li><strong>Open the Collection Runner:</strong> In Postman, click the <strong>Runner</strong> tab.</li>
            <li><strong>Select the Folder:</strong> Drag <strong><code>02 - Update Iflow Configuration</code></strong> into the runner panel.</li>
            <li><strong>Load the Data File:</strong> Click <strong>Select File</strong> and upload your prepared CSV file.</li>
            <li><strong>Run the Collection:</strong> Click <strong>Run Integration Content - Automation</strong>.</li>
        </ol>

        <h4>Workflow Steps (Runner Logic)</h4>
        <table>
            <thead>
                <tr>
                    <th>Request Name</th>
                    <th>Iteration 0 (Setup)</th>
                    <th>Iteration &ge; 1 (Loop)</th>
                    <th>Purpose</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong><code>Iteration Check</code></strong></td>
                    <td class="runner-step">Clears tokens, initializes <code>csvResults</code>, proceeds to <code>Get Auth Token</code>.</td>
                    <td class="runner-step"><strong>Jumps directly to <code>Update configuration...</code></strong></td>
                    <td>The router that controls efficient looping.</td>
                </tr>
                <tr>
                    <td><strong><code>Get Auth Token</code></strong></td>
                    <td class="runner-step">Fetches <code>accessToken</code>, proceeds to <code>Get CSRF token</code>.</td>
                    <td class="runner-step"><strong>Skipped</strong></td>
                    <td>Authorizes the session (once per run).</td>
                </tr>
                <tr>
                    <td><strong><code>Get CSRF token</code></strong></td>
                    <td class="runner-step">Fetches <code>csrfToken</code>, proceeds to <code>Update configuration...</code>.</td>
                    <td class="runner-step"><strong>Skipped</strong></td>
                    <td>Fetches the token required for the <code>PUT</code> (write) operation (once per run).</td>
                </tr>
                <tr>
                    <td><strong><code>Update configuration parameter...</code></strong></td>
                    <td>Executes the update for the first data row.</td>
                    <td>Executes the update for the current data row.</td>
                    <td>The main request. Updates the config and appends the outcome to <code>csvResults</code>. On the last row, it sends the full CSV report to the <code>nodeServerUrl</code>.</td>
                </tr>
            </tbody>
        </table>

        <h3 id="section-3-4">3.4. Detailed Workflows: Mass Deployment and Undeployment</h3>
        <p>These folders automate mass operations (Deploy/Undeploy) using the <strong>Postman Collection Runner</strong> and a data file. All folders utilize the same token/CSRF skipping logic as Folder 02.</p>

        <h4>General Steps to Run</h4>
        <ol>
            <li><strong>Prepare the Data File:</strong> Create a CSV file with the required headers for the specific operation.</li>
            <li><strong>Open the Collection Runner:</strong> In Postman, click the <strong>Runner</strong> tab.</li>
            <li><strong>Select the Folder:</strong> Drag and drop the specific folder into the runner panel.</li>
            <li><strong>Load the Data File:</strong> Click <strong>Select File</strong> and upload the CSV file you prepared.</li>
            <li><strong>Run the Collection:</strong> Click <strong>Run Integration Content - Automation</strong>.</li>
        </ol>

        <br>
        
        <h4>Folder 03: Deploy Iflows</h4>
        <table>
            <thead>
                <tr>
                    <th>Action</th>
                    <th>API Call</th>
                    <th>Required Data File Headers</th>
                    <th>Output Variable</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Deploy iFlow</td>
                    <td><code>POST .../DeployIntegrationDesigntimeArtifact</code></td>
                    <td><strong><code>IflowID</code></strong>, <code>Version</code> (optional)</td>
                    <td><code>deployIflowsResults</code></td>
                </tr>
            </tbody>
        </table>
        <p><strong>Sample CSV Input (<code>Deploy_IFlows.csv</code>):</strong></p>
        <pre><code>IflowID,Version
IFLOW_A,active
IFLOW_B,1.0.0
IFLOW_C,</code></pre>

        <h4>Folder 04: UnDeploy Iflows</h4>
        <table>
            <thead>
                <tr>
                    <th>Action</th>
                    <th>API Call</th>
                    <th>Required Data File Headers</th>
                    <th>Output Variable</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Undeploy iFlow</td>
                    <td><code>DELETE .../IntegrationRuntimeArtifacts('{{IflowID}}')</code></td>
                    <td><strong><code>IflowID</code></strong></td>
                    <td><code>undeployIflowsResults</code></td>
                </tr>
            </tbody>
        </table>
        <p><strong>Sample CSV Input (<code>Undeploy_IFlows.csv</code>):</strong></p>
        <pre><code>IflowID
IFLOW_A
IFLOW_C
IFLOW_D</code></pre>

        <h4>Folder 05: Deploy Script Collections</h4>
        <table>
            <thead>
                <tr>
                    <th>Action</th>
                    <th>API Call</th>
                    <th>Required Data File Headers</th>
                    <th>Output Variable</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Deploy Script Collection</td>
                    <td><code>POST .../DeployScriptCollectionDesigntimeArtifact</code></td>
                    <td><strong><code>ScriptCollectionID</code></strong>, <code>Version</code> (optional)</td>
                    <td><code>deployScriptCollectionResults</code></td>
                </tr>
            </tbody>
        </table>
        <p><strong>Sample CSV Input (<code>Deploy_Scripts.csv</code>):</strong></p>
        <pre><code>ScriptCollectionID,Version
UTIL_SCRIPTS,1.0.0
AUTH_HANDLERS,active</code></pre>

        <h4>Folder 06: Deploy Value Mappings</h4>
        <table>
            <thead>
                <tr>
                    <th>Action</th>
                    <th>API Call</th>
                    <th>Required Data File Headers</th>
                    <th>Output Variable</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Deploy Value Mapping</td>
                    <td><code>POST .../DeployValueMappingDesigntimeArtifact</code></td>
                    <td><strong><code>ValueMappingID</code></strong>, <code>Version</code> (optional)</td>
                    <td><code>deployValueMappingResults</code></td>
                </tr>
            </tbody>
        </table>
        <p><strong>Sample CSV Input (<code>Deploy_VMaps.csv</code>):</strong></p>
        <pre><code>ValueMappingID,Version
MAP_COUNTRIES,active
MAP_STATUS_CODES,2.1.0</code></pre>

    </div>
</body>
</html>
